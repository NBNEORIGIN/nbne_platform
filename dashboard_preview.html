<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard — Today</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #f5f5f5; color: #111827;
    display: flex; min-height: 100vh;
  }

  /* ── Sidebar ── */
  .sidebar {
    width: 220px; background: #1e293b; color: #e2e8f0;
    padding: 1.5rem 1rem; flex-shrink: 0;
  }
  .sidebar h2 {
    font-size: 0.9rem; margin-bottom: 1.5rem; color: #fff;
    letter-spacing: 0.03em; font-weight: 600;
  }
  .sidebar a {
    display: block; padding: 0.5rem 0.75rem; border-radius: 6px;
    color: #94a3b8; text-decoration: none; font-size: 0.85rem; margin-bottom: 2px;
  }
  .sidebar a.active { background: #334155; color: #fff; font-weight: 600; }
  .sidebar a:hover { background: #334155; color: #fff; }

  /* ── Main ── */
  .main {
    flex: 1; padding: 2.5rem;
    display: flex; justify-content: center;
  }
  .content { width: 100%; max-width: 580px; }

  /* ── Header ── */
  .header h1 {
    font-size: 1.75rem; font-weight: 700; color: #111827;
    margin-bottom: 0.2rem;
  }
  .header .date {
    font-size: 0.85rem; color: #9ca3af; margin-bottom: 2rem;
    display: block;
  }

  /* ── State line ── */
  .state-line {
    font-size: 0.95rem; color: #6b7280; margin-bottom: 1.25rem;
  }

  /* ── Sorted banner ── */
  .sorted-banner {
    padding: 3rem 1.5rem; text-align: center; border-radius: 10px;
    border: 1px solid #e5e7eb; background: #fafafa;
  }
  .sorted-banner p {
    font-size: 1.05rem; font-weight: 500; color: #374151;
  }

  /* ── Issue card ── */
  .card {
    border: 1px solid #e5e7eb; border-radius: 10px;
    padding: 1.25rem 1.5rem; background: #fff;
    margin-bottom: 0.75rem;
    transition: opacity 0.3s ease, transform 0.3s ease;
  }
  .card.urgent {
    border-color: #fecaca; background: #fef2f2;
  }
  .card.resolving {
    opacity: 0.5; pointer-events: none;
  }
  .card.resolved {
    opacity: 0; transform: translateY(-8px);
    height: 0; padding: 0; margin: 0; border: none; overflow: hidden;
  }
  .card-title {
    font-size: 0.95rem; font-weight: 600; color: #111827;
    margin-bottom: 0.3rem;
  }
  .card.urgent .card-title { color: #991b1b; }
  .card-impact {
    font-size: 0.85rem; color: #6b7280; line-height: 1.4;
    margin-bottom: 1rem;
  }

  /* ── Feedback line (shown after action) ── */
  .card-feedback {
    font-size: 0.85rem; color: #374151; font-weight: 500;
    padding: 0.5rem 0; display: none;
  }
  .card.resolving .card-feedback { display: block; }
  .card.resolving .card-actions { display: none; }

  /* ── Primary button ── */
  .btn-primary {
    display: inline-block; padding: 0.5rem 1.25rem;
    border-radius: 6px; border: none;
    background: #111827; color: #fff;
    font-size: 0.85rem; font-weight: 500;
    cursor: pointer; transition: background 0.15s;
  }
  .btn-primary:hover { background: #1f2937; }
  .card.urgent .btn-primary { background: #dc2626; }
  .card.urgent .btn-primary:hover { background: #b91c1c; }

  .btn-reason {
    display: block; font-size: 0.75rem; color: #9ca3af;
    margin-top: 0.3rem;
  }

  /* ── Secondary actions ── */
  .secondary-label {
    font-size: 0.75rem; color: #9ca3af; margin: 0.75rem 0 0.35rem;
  }
  .secondary-actions { display: flex; flex-wrap: wrap; gap: 0.5rem; }
  .btn-secondary {
    padding: 0.3rem 0.75rem; border-radius: 5px;
    border: 1px solid #d1d5db; background: #fff; color: #374151;
    font-size: 0.8rem; cursor: pointer; transition: background 0.15s;
  }
  .btn-secondary:hover { background: #f3f4f6; }

  /* ── Preview toggle (dev only) ── */
  .preview-toggle {
    position: fixed; bottom: 1rem; right: 1rem;
    display: flex; gap: 0.4rem; z-index: 10;
  }
  .preview-toggle button {
    padding: 0.35rem 0.75rem; border-radius: 5px;
    border: 1px solid #d1d5db; background: #fff; color: #374151;
    font-size: 0.75rem; cursor: pointer;
  }
  .preview-toggle button.active {
    background: #111827; color: #fff; border-color: #111827;
  }
</style>
</head>
<body>

<!-- ── Sidebar ── -->
<nav class="sidebar">
  <h2>NBNE Platform</h2>
  <a href="#" class="active">Today</a>
  <a href="#">Bookings</a>
  <a href="#">Staff</a>
  <a href="#">Clients</a>
  <a href="#">Compliance</a>
  <a href="#">Documents</a>
  <a href="#">CRM</a>
  <a href="#">Analytics</a>
  <a href="#">Comms</a>
  <a href="#">Settings</a>
</nav>

<!-- ── Main ── -->
<div class="main">
<div class="content">

  <!-- Header -->
  <div class="header">
    <h1>Today</h1>
    <span class="date" id="today-date"></span>
  </div>

  <!-- ════════════════════════════════════════ -->
  <!-- STATE A: Active issues                  -->
  <!-- ════════════════════════════════════════ -->
  <div id="state-active">

    <div class="state-line" id="issue-count">3 issues need attention.</div>

    <!-- Card 1: Operational blocker — staff sick -->
    <div class="card urgent" id="card-1">
      <div class="card-title">Chloe off sick today</div>
      <div class="card-impact">4 bookings affected. No cover assigned.</div>
      <div class="card-feedback">Cover request sent to Sam (awaiting response).</div>
      <div class="card-actions">
        <button class="btn-primary" onclick="resolveCard('card-1', 'Cover request sent to Sam (awaiting response).')">
          Request cover from Sam
        </button>
        <span class="btn-reason">Next in 7-day rotation</span>
        <div class="secondary-label">Other options:</div>
        <div class="secondary-actions">
          <button class="btn-secondary" onclick="resolveCard('card-1', 'Cover request sent to Jordan.')">Request Jordan</button>
          <button class="btn-secondary" onclick="resolveCard('card-1', 'Owner covering Chloe\u2019s bookings.')">Owner cover</button>
        </div>
      </div>
    </div>

    <!-- Card 2: Operational blocker — unassigned booking -->
    <div class="card urgent" id="card-2">
      <div class="card-title">Unassigned booking — 11:00</div>
      <div class="card-impact">Emma Watson — Full Colour. No stylist assigned.</div>
      <div class="card-feedback">Assigned to Sam.</div>
      <div class="card-actions">
        <button class="btn-primary" onclick="resolveCard('card-2', 'Assigned to Sam.')">
          Assign Sam
        </button>
        <span class="btn-reason">Available for Full Colour</span>
        <div class="secondary-label">Other options:</div>
        <div class="secondary-actions">
          <button class="btn-secondary" onclick="resolveCard('card-2', 'Assigned to Jordan.')">Assign Jordan</button>
          <button class="btn-secondary" onclick="resolveCard('card-2', 'Booking rescheduled.')">Reschedule</button>
        </div>
      </div>
    </div>

    <!-- Card 3: Revenue risk — deposit missing -->
    <div class="card" id="card-3">
      <div class="card-title">Deposit missing — 14:00</div>
      <div class="card-impact">Sarah Connor — Balayage. £85 outstanding.</div>
      <div class="card-feedback">Payment request sent.</div>
      <div class="card-actions">
        <button class="btn-primary" onclick="resolveCard('card-3', 'Payment request sent.')">
          Request payment
        </button>
        <span class="btn-reason">£85.00 outstanding</span>
        <div class="secondary-label">Other options:</div>
        <div class="secondary-actions">
          <button class="btn-secondary" onclick="resolveCard('card-3', 'Marked as paid.')">Mark as paid</button>
          <button class="btn-secondary" onclick="resolveCard('card-3', 'Booking cancelled.')">Cancel booking</button>
        </div>
      </div>
    </div>

  </div>

  <!-- ════════════════════════════════════════ -->
  <!-- STATE B: Sorted (calm)                  -->
  <!-- ════════════════════════════════════════ -->
  <div id="state-sorted" style="display: none;">
    <div class="sorted-banner">
      <p>No active issues. Sorted.</p>
    </div>
  </div>

</div>
</div>

<!-- Dev toggle -->
<div class="preview-toggle">
  <button class="active" onclick="resetDemo()">Reset</button>
  <button onclick="showSorted()">Show Sorted</button>
</div>

<script>
  // Date
  document.getElementById('today-date').textContent =
    new Date().toLocaleDateString('en-GB', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });

  let totalCards = 3;
  let resolvedCount = 0;

  function resolveCard(id, feedback) {
    const card = document.getElementById(id);
    if (!card || card.classList.contains('resolving')) return;

    // Show feedback
    card.querySelector('.card-feedback').textContent = feedback;
    card.classList.add('resolving');

    // After a beat, remove the card
    setTimeout(() => {
      card.classList.add('resolved');
      resolvedCount++;
      updateCount();
    }, 1500);
  }

  function updateCount() {
    const remaining = totalCards - resolvedCount;
    const countEl = document.getElementById('issue-count');
    if (remaining <= 0) {
      // Transition to sorted
      document.getElementById('state-active').style.display = 'none';
      document.getElementById('state-sorted').style.display = 'block';
    } else {
      countEl.textContent = remaining + ' issue' + (remaining !== 1 ? 's' : '') +
        ' need' + (remaining === 1 ? 's' : '') + ' attention.';
    }
  }

  function showSorted() {
    document.getElementById('state-active').style.display = 'none';
    document.getElementById('state-sorted').style.display = 'block';
  }

  function resetDemo() {
    resolvedCount = 0;
    document.getElementById('state-active').style.display = 'block';
    document.getElementById('state-sorted').style.display = 'none';
    document.getElementById('issue-count').textContent = '3 issues need attention.';
    document.querySelectorAll('.card').forEach(c => {
      c.classList.remove('resolving', 'resolved');
      c.style.height = ''; c.style.padding = ''; c.style.margin = '';
      c.style.border = ''; c.style.overflow = '';
    });
  }
</script>

</body>
</html>
