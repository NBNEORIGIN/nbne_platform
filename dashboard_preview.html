<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard — Today</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #f5f5f5; color: #111827;
    display: flex; min-height: 100vh;
  }

  /* ── Sidebar ── */
  .sidebar {
    width: 220px; background: #1e293b; color: #e2e8f0;
    padding: 1.5rem 1rem; flex-shrink: 0;
  }
  .sidebar h2 {
    font-size: 0.9rem; margin-bottom: 1.5rem; color: #fff;
    letter-spacing: 0.03em; font-weight: 600;
  }
  .sidebar a {
    display: block; padding: 0.5rem 0.75rem; border-radius: 6px;
    color: #94a3b8; text-decoration: none; font-size: 0.85rem; margin-bottom: 2px;
  }
  .sidebar a.active { background: #334155; color: #fff; font-weight: 600; }
  .sidebar a:hover { background: #334155; color: #fff; }

  /* ── Main ── */
  .main { flex: 1; padding: 2.5rem; }
  .content { max-width: 680px; margin: 0 auto; }

  /* ── Header ── */
  .header {
    display: flex; align-items: baseline; justify-content: space-between;
    margin-bottom: 1.75rem;
  }
  .header h1 {
    font-size: 1.75rem; font-weight: 700; color: #111827;
    margin-bottom: 0.15rem;
  }
  .header .subtitle {
    font-size: 0.9rem; color: #6b7280;
  }

  /* ── View toggle ── */
  .view-toggle { display: flex; gap: 0.35rem; }
  .view-toggle button {
    padding: 0.3rem 0.85rem; border-radius: 5px;
    border: 1px solid #d1d5db; background: #fff; color: #6b7280;
    font-size: 0.8rem; font-weight: 500; cursor: pointer;
  }
  .view-toggle button.on {
    background: #111827; color: #fff; border-color: #111827;
  }

  /* ── Calm banner ── */
  .calm-banner {
    padding: 3rem 1.5rem; text-align: center; border-radius: 8px;
    border: 1px solid #e5e7eb; background: #fafafa;
  }
  .calm-banner p {
    font-size: 0.95rem; font-weight: 500; color: #374151;
  }

  /* ── Issue row ── */
  .issue-row {
    display: flex; align-items: flex-start; gap: 1.25rem; flex-wrap: wrap;
    padding: 0.85rem 0;
    border-bottom: 1px solid #f0f0f0;
    transition: opacity 0.3s ease;
  }
  .issue-row.resolving { opacity: 0.5; pointer-events: none; }
  .issue-row.resolved {
    opacity: 0; height: 0; padding: 0; margin: 0;
    border: none; overflow: hidden;
    transition: opacity 0.3s ease, height 0s 0.3s;
  }

  /* Situation text */
  .issue-row .situation {
    flex: 1 1 280px; font-size: 0.9rem; color: #111827; line-height: 1.5;
  }

  /* Action area */
  .issue-row .action-area { flex-shrink: 0; }
  .btn-primary {
    display: inline-block; padding: 0.4rem 1rem;
    border-radius: 5px; border: none;
    background: #111827; color: #fff;
    font-size: 0.85rem; font-weight: 500;
    cursor: pointer; white-space: nowrap;
    transition: background 0.15s;
  }
  .btn-primary:hover { background: #1f2937; }
  .secondary-links { margin-top: 0.3rem; display: flex; gap: 0.6rem; flex-wrap: wrap; }
  .secondary-links a {
    font-size: 0.78rem; color: #6b7280; cursor: pointer;
    text-decoration: underline; text-underline-offset: 2px;
  }
  .secondary-links a:hover { color: #374151; }

  /* Reason text */
  .issue-row .reason {
    flex: 0 0 auto; font-size: 0.78rem; color: #9ca3af;
    max-width: 220px; line-height: 1.4;
  }

  /* Feedback (shown during resolve) */
  .issue-row .feedback {
    font-size: 0.9rem; color: #374151; display: none;
  }
  .issue-row.resolving .feedback { display: block; }
  .issue-row.resolving .live-content { display: none; }

  /* ── Resolved row (sorted view) ── */
  .resolved-row {
    display: flex; align-items: baseline; justify-content: space-between;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f3f4f6;
  }
  .resolved-row .detail { font-size: 0.9rem; color: #374151; }
  .resolved-row .action-taken {
    font-size: 0.85rem; color: #059669; font-weight: 500;
    flex-shrink: 0; margin-left: 1rem;
  }

  /* ── Dev reset ── */
  .preview-toggle {
    position: fixed; bottom: 1rem; right: 1rem;
    display: flex; gap: 0.4rem; z-index: 10;
  }
  .preview-toggle button {
    padding: 0.35rem 0.75rem; border-radius: 5px;
    border: 1px solid #d1d5db; background: #fff; color: #374151;
    font-size: 0.75rem; cursor: pointer;
  }
  .preview-toggle button.active {
    background: #111827; color: #fff; border-color: #111827;
  }
</style>
</head>
<body>

<!-- ── Sidebar ── -->
<nav class="sidebar">
  <h2>NBNE Platform</h2>
  <a href="#" class="active">Today</a>
  <a href="#">Bookings</a>
  <a href="#">Staff</a>
  <a href="#">Clients</a>
  <a href="#">Compliance</a>
  <a href="#">Documents</a>
  <a href="#">CRM</a>
  <a href="#">Analytics</a>
  <a href="#">Comms</a>
  <a href="#">Settings</a>
</nav>

<!-- ── Main ── -->
<div class="main">
<div class="content">

  <!-- Header -->
  <div class="header">
    <div>
      <h1>Today</h1>
      <div class="subtitle" id="subtitle">3 things need sorting.</div>
    </div>
    <div class="view-toggle">
      <button class="on" id="btn-active" onclick="switchView('active')">Active</button>
      <button id="btn-sorted" onclick="switchView('sorted')">Sorted</button>
    </div>
  </div>

  <!-- ═══ Active view ═══ -->
  <div id="state-active">

    <!-- Row 1 -->
    <div class="issue-row" id="row-1">
      <div class="feedback">Request sent to Jordan &mdash; awaiting response.</div>
      <div class="live-content" style="display:contents">
        <div class="situation">Chloe is off today. 4 bookings need cover.</div>
        <div class="action-area">
          <button class="btn-primary" onclick="resolveRow('row-1','Ask Jordan to cover')">Ask Jordan to cover</button>
          <div class="secondary-links">
            <a onclick="resolveRow('row-1','Ask Sam to cover')">Ask Sam</a>
            <a onclick="resolveRow('row-1','Owner cover')">Owner cover</a>
          </div>
        </div>
        <div class="reason">Jordan is next in 7-day rotation and available.</div>
      </div>
    </div>

    <!-- Row 2 -->
    <div class="issue-row" id="row-2">
      <div class="feedback">Assigned to Sam.</div>
      <div class="live-content" style="display:contents">
        <div class="situation">11:00 Full Colour for Emma Watson has no stylist.</div>
        <div class="action-area">
          <button class="btn-primary" onclick="resolveRow('row-2','Assign Sam')">Assign Sam</button>
          <div class="secondary-links">
            <a onclick="resolveRow('row-2','Assign Jordan')">Assign Jordan</a>
            <a onclick="resolveRow('row-2','Reschedule')">Reschedule</a>
          </div>
        </div>
        <div class="reason">Sam is qualified for Full Colour and available at 11:00.</div>
      </div>
    </div>

    <!-- Row 3 -->
    <div class="issue-row" id="row-3">
      <div class="feedback">Payment request sent.</div>
      <div class="live-content" style="display:contents">
        <div class="situation">Sarah Connor&rsquo;s Balayage at 14:00 has no deposit. &pound;85 at risk.</div>
        <div class="action-area">
          <button class="btn-primary" onclick="resolveRow('row-3','Request payment')">Request payment</button>
          <div class="secondary-links">
            <a onclick="resolveRow('row-3','Mark as paid')">Mark as paid</a>
            <a onclick="resolveRow('row-3','Cancel booking')">Cancel booking</a>
          </div>
        </div>
        <div class="reason">&pound;85.00 outstanding. No deposit recorded.</div>
      </div>
    </div>

  </div>

  <!-- ═══ Sorted view ═══ -->
  <div id="view-sorted" style="display: none;">
    <div id="resolved-list"></div>
    <div id="resolved-empty" class="calm-banner">
      <p>Nothing resolved yet today.</p>
    </div>
  </div>

  <!-- ═══ All clear ═══ -->
  <div id="all-clear" style="display: none;">
    <div class="calm-banner">
      <p>All sorted. You&rsquo;re good.</p>
    </div>
  </div>

</div>
</div>

<!-- Dev reset -->
<div class="preview-toggle">
  <button class="active" onclick="resetDemo()">Reset Demo</button>
</div>

<script>
  const totalRows = 3;
  let resolvedCount = 0;
  const resolvedItems = [];

  const rowData = {
    'row-1': { detail: 'Chloe is off today. 4 bookings need cover.' },
    'row-2': { detail: '11:00 Full Colour for Emma Watson has no stylist.' },
    'row-3': { detail: 'Sarah Connor\u2019s Balayage at 14:00 has no deposit. \u00A385 at risk.' },
  };

  function resolveRow(id, label) {
    const row = document.getElementById(id);
    if (!row || row.classList.contains('resolving')) return;

    row.querySelector('.feedback').textContent = label + ' \u2014 awaiting response.';
    row.classList.add('resolving');

    setTimeout(() => {
      row.classList.add('resolved');
      resolvedCount++;
      resolvedItems.push({ detail: rowData[id].detail, action: label });
      updateUI();
    }, 1500);
  }

  function updateUI() {
    const remaining = totalRows - resolvedCount;
    const sub = document.getElementById('subtitle');
    if (remaining <= 0) {
      sub.textContent = 'All sorted. You\u2019re good.';
      document.getElementById('state-active').style.display = 'none';
      document.getElementById('all-clear').style.display = 'block';
    } else {
      sub.textContent = remaining + ' thing' + (remaining !== 1 ? 's' : '') +
        ' need' + (remaining === 1 ? 's' : '') + ' sorting.';
    }
    document.getElementById('btn-sorted').textContent =
      'Sorted' + (resolvedItems.length > 0 ? ' (' + resolvedItems.length + ')' : '');
  }

  function renderResolved() {
    const list = document.getElementById('resolved-list');
    const empty = document.getElementById('resolved-empty');
    if (resolvedItems.length === 0) {
      list.innerHTML = '';
      empty.style.display = 'block';
      return;
    }
    empty.style.display = 'none';
    list.innerHTML = resolvedItems.map(r =>
      '<div class="resolved-row">' +
        '<div class="detail">' + r.detail + '</div>' +
        '<div class="action-taken">' + r.action + '</div>' +
      '</div>'
    ).join('');
  }

  function switchView(view) {
    document.getElementById('btn-active').classList.toggle('on', view === 'active');
    document.getElementById('btn-sorted').classList.toggle('on', view === 'sorted');

    if (view === 'sorted') {
      document.getElementById('state-active').style.display = 'none';
      document.getElementById('all-clear').style.display = 'none';
      document.getElementById('view-sorted').style.display = 'block';
      renderResolved();
    } else {
      document.getElementById('view-sorted').style.display = 'none';
      if (resolvedCount >= totalRows) {
        document.getElementById('state-active').style.display = 'none';
        document.getElementById('all-clear').style.display = 'block';
      } else {
        document.getElementById('state-active').style.display = 'block';
        document.getElementById('all-clear').style.display = 'none';
      }
    }
  }

  function resetDemo() {
    resolvedCount = 0;
    resolvedItems.length = 0;
    document.getElementById('subtitle').textContent = '3 things need sorting.';
    document.getElementById('state-active').style.display = 'block';
    document.getElementById('view-sorted').style.display = 'none';
    document.getElementById('all-clear').style.display = 'none';
    document.getElementById('btn-active').classList.add('on');
    document.getElementById('btn-sorted').classList.remove('on');
    document.getElementById('btn-sorted').textContent = 'Sorted';
    document.querySelectorAll('.issue-row').forEach(r => {
      r.classList.remove('resolving', 'resolved');
      r.style.height = ''; r.style.padding = ''; r.style.margin = '';
      r.style.border = ''; r.style.overflow = '';
    });
    renderResolved();
  }
</script>

</body>
</html>
